var HintClass="hintTextbox",HintActiveClass="hintTextboxActive",MiniHintClass="hintTextboxMini",MiniHintActiveClass="hintTextboxActiveMini";function initHintTextboxes(){var e=document.getElementsByTagName("input");for(i=0;i<e.length;i++){var t=e[i];"text"!=t.type&&"password"!=t.type||-1!=t.className.indexOf(HintClass)&&(t.hintText=t.value,t.className=-1!=t.className.indexOf(MiniHintClass)?MiniHintClass:HintClass,t.onfocus=onHintTextboxFocus,t.onblur=onHintTextboxBlur)}}function resetHintTextboxes(){var e=document.getElementsByTagName("input");for(i=0;i<e.length;i++){var t=e[i];"text"!=t.type&&"password"!=t.type||-1!=t.className.indexOf(HintClass)&&(t.className=-1!=t.className.indexOf(MiniHintClass)?MiniHintClass:HintClass,t.value=t.hintText)}}function onHintTextboxFocus(){var e=this;e.value.trim()==e.hintText&&(e.value="",e.className=-1!=e.className.indexOf(MiniHintClass)?MiniHintActiveClass:HintActiveClass)}function onHintTextboxBlur(){var e=this;0==e.value.trim().length&&(e.value=e.hintText,e.className=-1!=e.className.indexOf(MiniHintClass)?MiniHintClass:HintClass)}var SORT_COLUMN_INDEX,image_path="/img/",image_up="arrow-up.gif",image_down="arrow-down.gif",image_none="arrow-none.gif",europeandate=!0,alternate_row_colors=!0;addEvent(window,"load",sortables_init);var thead=!1;function sortables_init(){if(document.getElementsByTagName)for(tbls=document.getElementsByTagName("table"),ti=0;ti<tbls.length;ti++)thisTbl=tbls[ti],-1!=(" "+thisTbl.className+" ").indexOf("sortable")&&thisTbl.id&&ts_makeSortable(thisTbl)}function ts_makeSortable(e){if(e.rows&&e.rows.length>0)if(e.tHead&&e.tHead.rows.length>0){var t=e.tHead.rows[e.tHead.rows.length-1];thead=!0}else t=e.rows[0];if(t){for(var s=0;s<t.cells.length;s++){var a=t.cells[s],n=ts_getInnerText(a);"unsortable"!=a.className&&-1==a.className.indexOf("unsortable")&&(a.innerHTML='<a href="#" class="sortheader" onclick="ts_resortTable(this, '+s+');return false;">'+n+'<span class="sortarrow">&nbsp;<img src="'+image_path+image_none+'" alt="&darr;"/></span></a>')}alternate_row_colors&&alternate(e)}}function ts_getInnerText(e){if("string"==typeof e)return e;if(void 0===e)return e;if(e.innerText)return e.innerText;for(var t="",s=e.childNodes,a=s.length,n=0;n<a;n++)switch(s[n].nodeType){case 1:t+=ts_getInnerText(s[n]);break;case 3:t+=s[n].nodeValue}return t}function ts_resortTable(e,t){for(var s,a=0;a<e.childNodes.length;a++)e.childNodes[a].tagName&&"span"==e.childNodes[a].tagName.toLowerCase()&&(s=e.childNodes[a]);ts_getInnerText(s);var n=e.parentNode,r=t||n.cellIndex,i=getParent(n,"TABLE");if(!(i.rows.length<=1)){for(var o="",l=1;""==o&&l<i.tBodies[0].rows.length;){"\x3c!--"!=(o=trim(o=ts_getInnerText(i.tBodies[0].rows[l].cells[r]))).substr(0,4)&&0!=o.length||(o=""),l++}if(""!=o){sortfn=ts_sort_caseinsensitive,o.match(/^\d\d[\/\.-][a-zA-z][a-zA-Z][a-zA-Z][\/\.-]\d\d\d\d$/)&&(sortfn=ts_sort_date),o.match(/^\d\d[\/\.-]\d\d[\/\.-]\d\d\d{2}?$/)&&(sortfn=ts_sort_date),o.match(/^-?[£$Û¢´]\d/)&&(sortfn=ts_sort_numeric),o.match(/^-?(\d+[,\.]?)+(E[-+][\d]+)?%?$/)&&(sortfn=ts_sort_numeric),SORT_COLUMN_INDEX=r;var d=new Array,c=new Array;for(k=0;k<i.tBodies.length;k++)for(l=0;l<i.tBodies[k].rows[0].length;l++)d[l]=i.tBodies[k].rows[0][l];for(k=0;k<i.tBodies.length;k++)if(thead)for(j=0;j<i.tBodies[k].rows.length;j++)c[j]=i.tBodies[k].rows[j];else for(j=1;j<i.tBodies[k].rows.length;j++)c[j-1]=i.tBodies[k].rows[j];for(c.sort(sortfn),"down"==s.getAttribute("sortdir")?(ARROW='&nbsp;<img src="'+image_path+image_down+'" alt="&darr;"/>',c.reverse(),s.setAttribute("sortdir","up")):(ARROW='&nbsp;<img src="'+image_path+image_up+'" alt="&uarr;"/>',s.setAttribute("sortdir","down")),l=0;l<c.length;l++)(!c[l].className||c[l].className&&-1==c[l].className.indexOf("sortbottom"))&&i.tBodies[0].appendChild(c[l]);for(l=0;l<c.length;l++)c[l].className&&-1!=c[l].className.indexOf("sortbottom")&&i.tBodies[0].appendChild(c[l]);var u=document.getElementsByTagName("span");for(a=0;a<u.length;a++)"sortarrow"==u[a].className&&getParent(u[a],"table")==getParent(e,"table")&&(u[a].innerHTML='&nbsp;<img src="'+image_path+image_none+'" alt="&darr;"/>');s.innerHTML=ARROW,alternate(i)}}}function getParent(e,t){return null==e?null:1==e.nodeType&&e.tagName.toLowerCase()==t.toLowerCase()?e:getParent(e.parentNode,t)}function sort_date(e){if(dt="00000000",11==e.length){switch(mtstr=e.substr(3,3),mtstr=mtstr.toLowerCase(),mtstr){case"jan":var t="01";break;case"feb":t="02";break;case"mar":t="03";break;case"apr":t="04";break;case"may":t="05";break;case"jun":t="06";break;case"jul":t="07";break;case"aug":t="08";break;case"sep":t="09";break;case"oct":t="10";break;case"nov":t="11";break;case"dec":t="12"}return dt=e.substr(7,4)+t+e.substr(0,2),dt}return 10==e.length?0==europeandate?(dt=e.substr(6,4)+e.substr(0,2)+e.substr(3,2),dt):(dt=e.substr(6,4)+e.substr(3,2)+e.substr(0,2),dt):8==e.length?(yr=e.substr(6,2),parseInt(yr)<50?yr="20"+yr:yr="19"+yr,1==europeandate?(dt=yr+e.substr(3,2)+e.substr(0,2),dt):(dt=yr+e.substr(0,2)+e.substr(3,2),dt)):dt}function ts_sort_date(e,t){return dt1=sort_date(ts_getInnerText(e.cells[SORT_COLUMN_INDEX])),dt2=sort_date(ts_getInnerText(t.cells[SORT_COLUMN_INDEX])),dt1==dt2?0:dt1<dt2?-1:1}function ts_sort_numeric(e,t){var s=ts_getInnerText(e.cells[SORT_COLUMN_INDEX]);s=clean_num(s);var a=ts_getInnerText(t.cells[SORT_COLUMN_INDEX]);return compare_numeric(s,a=clean_num(a))}function compare_numeric(e,t){e=parseFloat(e);e=isNaN(e)?0:e;t=parseFloat(t);return e-(t=isNaN(t)?0:t)}function ts_sort_caseinsensitive(e,t){return aa=ts_getInnerText(e.cells[SORT_COLUMN_INDEX]).toLowerCase(),bb=ts_getInnerText(t.cells[SORT_COLUMN_INDEX]).toLowerCase(),aa==bb?0:aa<bb?-1:1}function ts_sort_default(e,t){return aa=ts_getInnerText(e.cells[SORT_COLUMN_INDEX]),bb=ts_getInnerText(t.cells[SORT_COLUMN_INDEX]),aa==bb?0:aa<bb?-1:1}function addEvent(e,t,s,a){return e.addEventListener?(e.addEventListener(t,s,a),!0):e.attachEvent?e.attachEvent("on"+t,s):void alert("Handler could not be removed")}function clean_num(e){return e=e.replace(new RegExp(/[^-?0-9.]/g),"")}function trim(e){return e.replace(/^\s+|\s+$/g,"")}function alternate(e){for(var t=e.getElementsByTagName("tbody"),s=0;s<t.length;s++)for(var a=t[s].getElementsByTagName("tr"),n=0;n<a.length;n++)n%2==0?-1!=a[n].className.indexOf("odd")?a[n].className=a[n].className.replace("odd","even"):-1==a[n].className.indexOf("even")&&(a[n].className+=" even"):-1!=a[n].className.indexOf("even")?a[n].className=a[n].className.replace("even","odd"):-1==a[n].className.indexOf("odd")&&(a[n].className+=" odd")}
